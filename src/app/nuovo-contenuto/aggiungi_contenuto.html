@if (successMessage) {
  <div class="position-fixed top-0 start-50 translate-middle-x mt-4 p-3 shadow-lg rounded-pill bg-success text-white fw-bold d-flex align-items-center gap-3"
       style="z-index: 9999; min-width: 300px; justify-content: center; animation: slideDown 0.5s ease-out;">
    <span style="font-size: 1.5rem;">âœ…</span>
    <span style="font-size: 1.1rem;">{{ successMessage }}</span>
  </div>
}

<div class="container py-4 py-md-5 font-sans">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8">
      <div class="card border-0 shadow-sm rounded-4 p-3 p-md-4 bg-white">

        <h2 class="fw-bold text-dark mb-4 text-center text-md-start">
          {{ idModifica ? 'Modifica Contenuto' : 'Aggiungi Nuovo Contenuto' }}
        </h2>

        <div class="mb-4">
          <label class="small fw-bold text-muted mb-2">COSA VUOI AGGIUNGERE?</label>
          <select class="form-select border-0 bg-light py-3" [(ngModel)]="tipoSelezionato">
            <option value="" disabled selected>Seleziona una categoria...</option>
            <option value="gioco">Videogioco</option>
            <option value="film">Film</option>
            <option value="serie">Serie TV</option>
          </select>
        </div>

        @if (tipoSelezionato) {
          <div class="fade-in">
            <div class="row g-3">
              <div class="col-12 col-md-8">
                <label class="small fw-bold text-muted">TITOLO</label>
                <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.titolo">
              </div>
              <div class="col-12 col-md-4">
                <label class="small fw-bold text-muted">ANNO</label>
                <input type="number" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.anno">
              </div>

              <div class="col-12">
                <label class="small fw-bold text-muted">DESCRIZIONE</label>
                <textarea class="form-control border-0 bg-light" rows="3" [(ngModel)]="nuovoContenuto.descrizione"></textarea>
              </div>

              <div class="col-12 col-md-6">
                <label class="small fw-bold text-muted">GENERE</label>
                <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.genere">
              </div>
              <div class="col-12 col-md-6">
                <label class="small fw-bold text-muted">LINK (INFO)</label>
                <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.link">
              </div>

              <div class="col-12">
                <label class="small fw-bold text-muted">LINK IMMAGINE</label>
                <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.immagine">
              </div>

              @if (tipoSelezionato === 'gioco') {
                <div class="col-12 col-md-6">
                  <label class="small fw-bold text-muted">CASA EDITRICE</label>
                  <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.casaEditrice">
                </div>
                <div class="col-12 col-md-6">
                  <label class="small fw-bold text-muted d-block">PIATTAFORME</label>
                  <div class="btn-group flex-wrap gap-1">
                    @for (p of listaPiattaformeApi; track p.id) {
                      <button class="btn btn-sm rounded-pill"
                              [class.btn-primary]="nuovoContenuto.piattaformeIds.includes(p.id)"
                              [class.btn-outline-secondary]="!nuovoContenuto.piattaformeIds.includes(p.id)"
                              (click)="togglePiattaforma(p.id)">{{p.nome}}</button>
                    }
                  </div>
                </div>
              }

              @if (tipoSelezionato === 'film') {
                <div class="col-12">
                  <label class="small fw-bold text-muted">CASA PRODUTTRICE</label>
                  <input type="text" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.casaProduttrice">
                </div>
              }

              @if (tipoSelezionato === 'serie') {
                <div class="col-12 col-md-6">
                  <label class="small fw-bold text-muted">NUMERO STAGIONI</label>
                  <input type="number" class="form-control border-0 bg-light" [(ngModel)]="nuovoContenuto.stagioni" min="1" >
                </div>
                <div class="col-12 col-md-6 d-flex align-items-center pt-3 pt-md-4">
                  <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" [(ngModel)]="nuovoContenuto.inCorso">
                    <label class="form-check-label fw-bold small text-muted">SERIE IN CORSO?</label>
                  </div>
                </div>
              }

              <div class="col-12 mt-4 mt-md-5">
                <button class="btn w-100 rounded-pill py-3 fw-bold shadow-sm"
                        [class.btn-warning]="idModifica"
                        [class.btn-success]="!idModifica"
                        (click)="salvaContenuto()">
                  {{ idModifica ? 'AGGIORNA MODIFICHE' : 'SALVA NEL DATABASE' }}
                </button>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
